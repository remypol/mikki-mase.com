---
/**
 * PriceDisplay Component
 * Handles price formatting with optional triple strike-through for launch special
 */

interface Props {
  price: number;
  compareAt?: number;
  previousPrice?: number; // For triple strike-through: compareAt â†’ previousPrice â†’ price
  currency?: 'USD' | 'EUR';
  size?: 'small' | 'default' | 'large';
  showSavings?: boolean;
  showLaunchLabel?: boolean;
}

const {
  price,
  compareAt,
  previousPrice,
  currency = 'USD',
  size = 'default',
  showSavings = true,
  showLaunchLabel = false
} = Astro.props;

const formatter = new Intl.NumberFormat('en-US', {
  style: 'currency',
  currency,
  minimumFractionDigits: 0,
});

const savings = compareAt ? Math.round((1 - price / compareAt) * 100) : 0;

const sizeClasses = {
  small: 'text-lg',
  default: 'text-3xl',
  large: 'text-5xl'
};

const compareSizeClasses = {
  small: 'text-sm',
  default: 'text-lg',
  large: 'text-xl'
};
---

<div class="price-display-wrapper">
  {showLaunchLabel && (
    <span class="launch-label">ðŸ”¥ LAUNCH SPECIAL</span>
  )}

  <div class="flex items-baseline gap-2 md:gap-3 flex-wrap justify-center">
    {/* Original price (compareAt) */}
    {compareAt && (
      <span class:list={[
        "text-gray-500 line-through",
        compareSizeClasses[size]
      ]}>
        {formatter.format(compareAt)}
      </span>
    )}

    {/* Previous price (for triple strike-through) */}
    {previousPrice && (
      <span class:list={[
        "text-gray-500 line-through",
        compareSizeClasses[size]
      ]}>
        {formatter.format(previousPrice)}
      </span>
    )}

    {/* Current price */}
    <span class:list={[
      "text-gold font-bold",
      sizeClasses[size]
    ]}>
      {formatter.format(price)}
    </span>
  </div>

  {compareAt && showSavings && savings > 0 && (
    <span class="discount-badge">
      {savings}% OFF
    </span>
  )}
</div>

<style>
  .price-display-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
  }

  .launch-label {
    color: #DC2626;
    font-size: 0.875rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    text-transform: uppercase;
  }

  .discount-badge {
    display: inline-block;
    background: linear-gradient(135deg, #CFB53B, #B8860B);
    color: #000;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-size: 0.875rem;
    font-weight: 700;
    margin-top: 0.25rem;
  }
</style>
